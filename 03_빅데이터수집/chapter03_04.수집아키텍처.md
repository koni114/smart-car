## chapter03_04 수집 파일럿 실행 1단계 - 수집 아키텍처
### 수집 요구사항 
- 요구사항1: 차량의 다양한 장치로부터 발생하는 로그 파일을 수집해서 기능별 상태를 점검
- 요구사항2: 운전자의 운행 정보가 담긴 로그를 실시간으로 수집해서 주행 패턴을 분석

#### 수집 요구사항 분석
|     |     |
| --- | --- |
| 수집 요구사항 구체화 | 분석 및 해결 방안 |
| 스마트카로부터 로그 파일이 주기적으로 발생한다 | 플럼을 이용해 대용량 배치 파일 및 실시간 로그 파일을 수집<br><br>\- 배치/실시간에 따라서 flume에서 수집되는 방법이 다름 |
| 스마트카의 배치 로그 파일 이벤트를 감지해야 한다 | 플럼의 Source 컴포넌트 중 SpoolDir를 이용해 주기적인 로그 파일 발생 이벤트를 감지 |
| 스마트카의 실시간 로그 발생 이벤트를 감지해야 한다 | 플럼의 Source 컴포넌트 중 Exec-Tail을 이용해 특정 로그 파일에서 로그 생성 이벤트를 감지 |
| 스마트카가 만들어내는 로그 데이터에 가비지 데이터가 있을 수 있음 | 플럼의 interceptor를 이용해 정상 패턴의 데이터만 필터링 |
| 수집 도중 장애가 발생해도 데이터를 안전하게 보관 및 재처리할 수 있어야 한다 | 플럼의 메모리 Channel 및 카프카 Broker 사용으로 로컬 디스크의 파일 시스템에 수집 데이터를 임시 저장 |
| 스마트카의 실시간 로그 파일은 비동기 처리로 빠름 수집 처리를 해야 한다 | 플럼에서 수집한 데이터를 플럼의 Sink 컴포넌트를 이용해 카프카 Topic에 비동기 전송 |

#### 수집 아키텍처
![img](https://github.com/koni114/smart-car/blob/master/img/smart_car_29.png)
